
---

## 6. Microservices

### 6.1 Frontend (React)

**Responsibilities**
- Render the 3×3 board
- Capture user clicks
- Send move requests via WebSocket
- Receive game state updates via WebSocket
- Display winner or draw messages

**Does NOT**
- Apply game rules
- Validate moves
- Decide turns or winners

---

### 6.2 Gateway Service (Python + WebSocket)

**Purpose**
Acts as the single entry point for all clients.

**Responsibilities**
- Maintain WebSocket connections with clients
- Receive move requests from players
- Publish move events to Kafka
- Subscribe to game state updates
- Push game state updates to connected clients

**Does NOT**
- Validate moves
- Hold game state
- Apply game rules

---

### 6.3 Kafka (Event Bus)

Kafka is used to decouple services and enable event-driven communication.

**Topics**
- `game-moves` – Player move requests
- `game-state-updates` – Authoritative game state updates
- `game-events` (optional) – GameStarted, GameFinished, WinnerDeclared

Kafka is not part of the real-time gameplay decision logic.

---

### 6.4 Game Logic Service (Python)

This service contains **all game rules**.

**Responsibilities**
- Consume move events from `game-moves`
- Maintain the authoritative game state
- Validate moves:
  - Correct player
  - Correct turn
  - Empty cell
  - Game still running
- Apply moves to the board
- Check for win or draw
- Switch turns
- Publish updated game state to `game-state-updates`

This is the **only place where game logic exists**.

---

### 6.5 Broadcaster Service (Python)

**Purpose**
Deliver game state updates to players.

**Responsibilities**
- Consume `game-state-updates`
- Broadcast the latest game state to all relevant players via WebSocket

**Does NOT**
- Modify game state
- Apply rules
- Validate moves

---

### 6.6 Optional: Events / Analytics Service

**Responsibilities**
- Consume `game-events`
- Store game history
- Log winners
- Enable future features (stats, replay, leaderboard)

This service must never affect gameplay.

---

## 7. Game State Model

### Running Game Example

```json
{
  "gameId": "game-123",
  "status": "RUNNING",
  "currentTurn": "X",
  "board": [
    ["X", "O", null],
    [null, "X", null],
    [null, "O", null]
  ],
  "players": {
    "player1": "X",
    "player2": "O"
  }
}
